<template>
  <div class="flex flex-col lg:flex-row gap-4 items-start">
    <StepSidebar
      class="lg:sticky lg:top-6 flex-shrink-0"
      :sections="stepSections"
      current-key="step3-motivation"
      title="STEP 3"
    />

    <div class="bg-[#f5fbff] border-4 border-black rounded-[28px] p-5 flex-1 space-y-4">
      <header class="space-y-2">
        <div class="flex items-center gap-3 text-lg font-bold">
          <span class="flex h-8 w-8 items-center justify-center rounded-full border-2 border-black bg-white">3</span>
          <span>‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏• (‡∏à‡∏π‡∏á‡πÉ‡∏à) ‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏≥‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ô‡∏µ‡πâ</span>
        </div>
        <p class="text-sm text-slate-600">
          ‡∏£‡∏∞‡∏ö‡∏∏‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ‡∏ó‡∏±‡πâ‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏á‡∏≤‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç
        </p>
      </header>

      <section class="rounded-[24px] border-4 border-black bg-white p-4 space-y-4">
        <div class="overflow-auto rounded-2xl border-2 border-black">
          <table class="w-full border-collapse text-sm">
            <thead>
              <tr class="bg-[#cfeeff] text-slate-900">
                <th colspan="2" class="border border-black px-3 py-2 text-center font-semibold">‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</th>
                <th colspan="2" class="border border-black px-3 py-2 text-center font-semibold">‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏á‡∏≤‡∏ô</th>
              </tr>
            </thead>
            <tbody>
              <tr v-for="row in motivationRows" :key="row.key" class="align-top">
                <td class="border border-black px-3 py-3 w-40">
                  <template v-if="row.left">
                    <div class="font-semibold text-slate-900">{{ row.left.title }}</div>
                    <div class="text-xs text-slate-500">{{ row.left.subtitle }}</div>
                  </template>
                </td>
                <td class="border border-black px-3 py-3">
                  <textarea
                    v-if="row.left"
                    v-model="row.left.value"
                    class="table-input min-h-[80px]"
                    placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏• ‡∏´‡∏£‡∏∑‡∏≠‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ï‡πà‡∏≠‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô"
                  ></textarea>
                </td>
                <td class="border border-black px-3 py-3 w-40">
                  <template v-if="row.right">
                    <div class="font-semibold text-slate-900">{{ row.right.title }}</div>
                    <div class="text-xs text-slate-500">{{ row.right.subtitle }}</div>
                  </template>
                </td>
                <td class="border border-black px-3 py-3">
                  <textarea
                    v-if="row.right"
                    v-model="row.right.value"
                    class="table-input min-h-[80px]"
                    placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏• ‡∏´‡∏£‡∏∑‡∏≠‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ï‡πà‡∏≠‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏á‡∏≤‡∏ô"
                  ></textarea>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <p class="text-xs text-slate-500">
          ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ú‡∏π‡πâ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏ó‡∏≥‡πÑ‡∏°‡∏ó‡∏µ‡∏°‡∏à‡∏∂‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß ‡∏´‡∏≤‡∏Å‡∏¢‡∏±‡∏á‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á‡πÑ‡∏î‡πâ
        </p>
      </section>

      <div class="flex flex-wrap gap-3 justify-end">
        <button class="action-btn bg-white" @click="goBack">¬´ ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
        <button class="action-btn bg-white" @click="saveMotivation">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
        <button class="action-btn bg-[#d9fbe7]" @click="goNext">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ¬ª</button>
      </div>
    </div>
  </div>
</template>

<script setup>
import { computed, reactive } from 'vue'
import { useRouter } from 'vue-router'
import StepSidebar from '@/components/StepSidebar.vue'
import { STEP1_AND_2_SIDEBAR } from '@/constants/qccSteps'

const stepSections = STEP1_AND_2_SIDEBAR
const router = useRouter()

const motivationColumns = reactive({
  workLife: [
    { key: 'safety', title: '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢', subtitle: 'Safety', value: '' },
    { key: 'environment', title: '‡∏™‡∏†‡∏≤‡∏û‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°', subtitle: 'Environment', value: '' },
    { key: 'development', title: '‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤', subtitle: 'Development', value: '' },
    { key: 'management', title: '‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£', subtitle: 'Management', value: '' },
  ],
  workQuality: [
    { key: 'quality', title: '‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û', subtitle: 'Quality', value: '' },
    { key: 'cost', title: '‡∏£‡∏≤‡∏Ñ‡∏≤', subtitle: 'Cost', value: '' },
    { key: 'delivery', title: '‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö', subtitle: 'Delivery', value: '' },
    { key: 'productivity', title: '‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï', subtitle: 'Productivity', value: '' },
  ],
})

const motivationRows = computed(() => {
  const max = Math.max(motivationColumns.workLife.length, motivationColumns.workQuality.length)
  return Array.from({ length: max }, (_, index) => ({
    key: `motivation-${index}`,
    left: motivationColumns.workLife[index] || null,
    right: motivationColumns.workQuality[index] || null,
  }))
})

function saveMotivation() {
  alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á)')
}

function goNext() {
  router.push('/step3/three-g')
}

function goBack() {
  router.push('/step2/priority')
}
</script>

<style scoped>
@reference "tailwindcss";

.table-input {
  @apply w-full rounded-xl border-2 border-black px-2 py-2 text-sm bg-white;
}

.action-btn {
  @apply rounded-2xl border-2 border-black px-4 py-2 text-sm font-semibold shadow hover:-translate-y-0.5 transition;
}
</style>
